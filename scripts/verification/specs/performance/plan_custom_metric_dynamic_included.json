{
  "id": "PLAN_CUSTOM_METRIC_DYN_INCLUDED",
  "pillar": "quality",
  "kind": "plan_and_run",
  "capabilities": ["planner", "performance", "custom_metric_inference", "sa360_parity", "sa360_accuracy"],
  "request": {
    "message": "Why did \"${DYN_INCLUDED_ACTION_NAME}\" change week over week? Which campaigns drove it?",
    "customer_ids": ["${TARGET_CUSTOMER_ID}"],
    "default_date_range": "${STABLE_LAST_30_DAYS}",
    "include_previous": true,
    "session_id": "${SESSION_ID}"
  },
  "expect": {
    "executed": true,
    "result.mode": "performance",
    "result.data_quality.custom_metric_inferred": true,
    "result.data_quality.custom_metric_key": "${DYN_INCLUDED_ACTION_METRIC_KEY}"
  },
  "assert": {
    "drivers_min": 1,
    "sa360_parity": {
      "source": "current_live",
      "compare_previous": true,
      "metrics": ["cost", "conversions", "${DYN_INCLUDED_ACTION_METRIC_KEY}", "ctr", "cpc"],
      "abs_tolerance": {
        "cost": 1.0,
        "conversions": 1,
        "${DYN_INCLUDED_ACTION_METRIC_KEY}": 2.0,
        "ctr": 0.05,
        "cpc": 0.05
      }
    },
    "sa360_accuracy": {
      "source": "current_live",
      "compare_previous": true,
      "metrics": ["cost", "conversions", "${DYN_INCLUDED_ACTION_METRIC_KEY}", "ctr", "cpc"],
      "require_report_names_echo": true,
      "require_source_frame_in_reports": true,
      "require_metric_presence": true
    }
  }
}

