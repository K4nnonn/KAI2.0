{
  "id": "PLAN_PERF_STABLE_7D_PARITY",
  "pillar": "quality",
  "kind": "plan_and_run",
  "capabilities": ["planner", "performance", "sa360_parity", "sa360_accuracy", "date_ranges"],
  "request": {
    "message": "Give me a performance summary for the last 7 complete days.",
    "customer_ids": ["${TARGET_CUSTOMER_ID}"],
    "default_date_range": "${STABLE_LAST_7_DAYS}",
    "include_previous": true,
    "session_id": "${SESSION_ID}"
  },
  "expect": {
    "executed": true,
    "result.mode": "performance"
  },
  "assert": {
    "summary_matches_result": ["conversions", "cost", "ctr", "cpc"],
    "sa360_parity": {
      "source": "current_live",
      "compare_previous": true,
      "metrics": ["impressions", "clicks", "cost", "conversions", "ctr", "cpc", "cpa", "roas"],
      "abs_tolerance": {
        "impressions": 1,
        "clicks": 1,
        "cost": 1.0,
        "conversions": 1,
        "ctr": 0.05,
        "cpc": 0.05,
        "cpa": 0.2,
        "roas": 0.01
      }
    },
    "sa360_accuracy": {
      "source": "current_live",
      "compare_previous": true,
      "metrics": ["impressions", "clicks", "cost", "conversions", "ctr", "cpc", "cpa", "roas"],
      "require_report_names_echo": true,
      "require_source_frame_in_reports": true,
      "require_metric_presence": true
    },
    "text_not_contains": {
      "summary": ["No close metric match found"]
    }
  }
}

